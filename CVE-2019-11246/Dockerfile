FROM noirfate/k8svul-base:1.0
COPY go1.11.1.linux-amd64.tar.gz /root
RUN tar -C /usr/local/ -xzf go1.11.1.linux-amd64.tar.gz && ln -s /usr/local/go/bin/go /usr/bin/go && ln -s /usr/local/go/bin/gofmt /usr/bin/gofmt && rm -f go1.11.1.linux-amd64.tar.gz && echo 'GOPROXY="https://mirrors.aliyun.com/goproxy/,direct"' > /etc/environment  && echo "add-auto-load-safe-path /usr/local/go/src/runtime/runtime-gdb.py" >> ~/.gdbinit
ADD kubernetes-1.13.5.tar.gz /root/
RUN sed -i 's/goldflags=.*/goldflags=""/' /root/kubernetes-1.13.5/hack/lib/golang.sh
ADD exploit.tar.gz /root/
ENTRYPOINT ["/sbin/init"]
